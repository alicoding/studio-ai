const io = require('socket.io-client');

// Connect to Socket.io
const socket = io('http://localhost:3456');

socket.on('connect', () => {
  console.log('Connected to Socket.io');
});

socket.on('workflow:update', (data) => {
  console.log('Workflow event:', data);
});

socket.on('message:new', (data) => {
  console.log('Message event:', data);
});

// Test blocking invoke
fetch('http://localhost:3456/api/invoke', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    workflow: {
      role: 'developer',
      task: 'Say hello'
    },
    projectId: '93b33a8b-dbc0-4b09-99ed-cb737239b409'
  })
})
.then(res => res.json())
.then(data => {
  console.log('Invoke response:', data);
  setTimeout(() => process.exit(0), 2000);
})
.catch(err => console.error('Error:', err));