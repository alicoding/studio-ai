#!/usr/bin/env sh

# Auto-rebuild semantic index after merging branches
echo "ğŸ”„ Checking if semantic index needs rebuild after merge..."

# Check if any source files changed
CHANGED_FILES=$(git diff --name-only HEAD@{1} HEAD | grep -E 'src/.*\.(ts|js|tsx|jsx)$' || true)

if [ -n "$CHANGED_FILES" ]; then
    echo "ğŸ“ Source files changed during merge, rebuilding semantic index..."
    npm run build-semantic-index --silent || echo "âš ï¸  Semantic index build failed"
    echo "âœ… Semantic index update complete"
else
    echo "â„¹ï¸  No source changes in merge, skipping semantic index rebuild"
fi